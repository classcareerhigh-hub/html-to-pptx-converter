<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI-Powered PT Generator - Career High</title>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Header */
    .header {
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
      padding: 40px;
      margin-bottom: 30px;
      text-align: center;
    }

    .logo {
      font-size: 60px;
      margin-bottom: 20px;
    }

    h1 {
      font-size: 36px;
      font-weight: 800;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #666;
      font-size: 18px;
    }

    /* Main Grid */
    .main-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 30px;
    }

    @media (max-width: 1024px) {
      .main-grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
      padding: 30px;
    }

    .card-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* API Settings */
    .api-settings {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
    }

    .api-status {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 10px;
    }

    .api-status.connected {
      background: #d1fae5;
      color: #065f46;
    }

    .api-status.disconnected {
      background: #fee2e2;
      color: #991b1b;
    }

    input[type="password"],
    input[type="text"] {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 14px;
      margin-bottom: 10px;
      transition: border-color 0.2s;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
    }

    /* File Upload */
    .upload-area {
      border: 3px dashed #d1d5db;
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: #f9fafb;
    }

    .upload-area:hover {
      border-color: #667eea;
      background: #f3f4f6;
    }

    .upload-area.dragover {
      border-color: #667eea;
      background: #eef2ff;
    }

    .upload-icon {
      font-size: 48px;
      margin-bottom: 16px;
    }

    .file-info {
      display: none;
      background: #e0e7ff;
      padding: 16px;
      border-radius: 8px;
      margin-top: 16px;
    }

    .file-info.show {
      display: block;
    }

    /* Progress */
    .progress-container {
      display: none;
      margin: 20px 0;
    }

    .progress-container.show {
      display: block;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      transition: width 0.3s;
      width: 0%;
    }

    .progress-text {
      font-size: 14px;
      color: #666;
      text-align: center;
    }

    /* Editor */
    textarea {
      width: 100%;
      height: 500px;
      padding: 16px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      resize: vertical;
    }

    textarea:focus {
      outline: none;
      border-color: #667eea;
    }

    /* Buttons */
    button {
      padding: 14px 28px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      width: 100%;
      justify-content: center;
      margin-bottom: 10px;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
    }

    .btn-primary:disabled {
      background: #d1d5db;
      cursor: not-allowed;
      transform: none;
    }

    .btn-secondary {
      background: #f3f4f6;
      color: #374151;
      width: 100%;
      justify-content: center;
    }

    .btn-secondary:hover {
      background: #e5e7eb;
    }

    .btn-small {
      padding: 8px 16px;
      font-size: 14px;
    }

    /* Alert */
    .alert {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }

    .alert.show {
      display: block;
    }

    .alert.success {
      background: #d1fae5;
      border: 1px solid #34d399;
      color: #065f46;
    }

    .alert.error {
      background: #fee2e2;
      border: 1px solid #f87171;
      color: #991b1b;
    }

    .alert.info {
      background: #dbeafe;
      border: 1px solid #60a5fa;
      color: #1e40af;
    }

    /* Instructions */
    .instructions {
      background: #fef3c7;
      border: 2px solid #fcd34d;
      border-radius: 12px;
      padding: 20px;
      margin-top: 20px;
      font-size: 14px;
    }

    .instructions strong {
      color: #92400e;
    }

    .instructions ul {
      margin: 10px 0 0 20px;
    }

    .instructions li {
      margin: 5px 0;
      color: #78350f;
    }

    /* Footer */
    .footer {
      text-align: center;
      color: white;
      font-size: 14px;
      margin-top: 30px;
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="logo">ğŸ¤–âœ¨</div>
      <h1>AI-Powered PT Generator</h1>
      <p class="subtitle">PDF ê¸°íšì•ˆì„ ì—…ë¡œë“œí•˜ë©´ AIê°€ ìë™ìœ¼ë¡œ ì™„ë²½í•œ í”„ë ˆì  í…Œì´ì…˜ì„ ë§Œë“¤ì–´ë“œë¦½ë‹ˆë‹¤</p>
    </div>

    <!-- Alert -->
    <div id="alert" class="alert"></div>

    <!-- Main Grid -->
    <div class="main-grid">
      <!-- Left: Upload & AI Generate -->
      <div class="card">
        <h2 class="card-title">
          <span>ğŸš€</span>
          <span>Step 1: AI ìë™ ìƒì„±</span>
        </h2>

        <!-- API Settings -->
        <div class="api-settings">
          <div style="margin-bottom: 12px;">
            <strong>Anthropic API í‚¤</strong>
            <span id="apiStatus" class="api-status disconnected">ë¯¸ì—°ê²°</span>
          </div>
          <input 
            type="password" 
            id="apiKeyInput" 
            placeholder="sk-ant-api03-xxxxx... API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
          />
          <button class="btn-secondary btn-small" onclick="saveApiKey()">
            <span>ğŸ’¾</span>
            <span>API í‚¤ ì €ì¥</span>
          </button>
          <div class="instructions">
            <strong>ğŸ’¡ API í‚¤ ë°œê¸‰ ë°©ë²•:</strong>
            <ul>
              <li><a href="https://console.anthropic.com" target="_blank">console.anthropic.com</a> ì ‘ì†</li>
              <li>"API Keys" â†’ "Create Key" í´ë¦­</li>
              <li>ìƒì„±ëœ í‚¤ë¥¼ ìœ„ì— ë¶™ì—¬ë„£ê¸°</li>
              <li>ì‹ ê·œ ê°€ì… ì‹œ $5 ë¬´ë£Œ í¬ë ˆë”§ ì œê³µ</li>
            </ul>
          </div>
        </div>

        <!-- File Upload -->
        <div 
          id="uploadArea" 
          class="upload-area"
          onclick="document.getElementById('fileInput').click()"
        >
          <div class="upload-icon">ğŸ“„</div>
          <div><strong>PDF íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì„¸ìš”</strong></div>
          <div style="color: #999; font-size: 14px; margin-top: 8px;">ìµœëŒ€ 10MB</div>
          <input 
            type="file" 
            id="fileInput" 
            accept=".pdf" 
            style="display: none;"
            onchange="handleFileSelect(event)"
          />
        </div>

        <div id="fileInfo" class="file-info">
          <strong>ğŸ“ ì„ íƒëœ íŒŒì¼:</strong> <span id="fileName"></span><br>
          <strong>ğŸ“Š í¬ê¸°:</strong> <span id="fileSize"></span>
        </div>

        <!-- Progress -->
        <div id="progressContainer" class="progress-container">
          <div class="progress-bar">
            <div id="progressFill" class="progress-fill"></div>
          </div>
          <div id="progressText" class="progress-text">ì¤€ë¹„ ì¤‘...</div>
        </div>

        <!-- Generate Button -->
        <button id="generateBtn" class="btn-primary" onclick="generateWithAI()" disabled>
          <span>ğŸ¤–</span>
          <span>AIë¡œ ìë™ ìƒì„±í•˜ê¸°</span>
        </button>

        <div class="instructions" style="margin-top: 20px;">
          <strong>âš™ï¸ AI í”„ë¡¬í”„íŠ¸ ì»¤ìŠ¤í„°ë§ˆì´ì§•:</strong><br>
          <input 
            type="text" 
            id="customPrompt" 
            placeholder="ì˜ˆ: 15ì¥ìœ¼ë¡œ ë§Œë“¤ì–´ì¤˜, ë°ì´í„° í‘œë¥¼ ë§ì´ ì‚¬ìš©í•´ì¤˜" 
            style="margin-top: 10px;"
          />
        </div>
      </div>

      <!-- Right: HTML Editor & Convert -->
      <div class="card">
        <h2 class="card-title">
          <span>ğŸ“</span>
          <span>Step 2: HTML í™•ì¸ ë° ë³€í™˜</span>
        </h2>

        <textarea 
          id="htmlEditor" 
          placeholder="AIê°€ ìƒì„±í•œ HTMLì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...

ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ ì§ì ‘ í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        ></textarea>

        <button class="btn-primary" onclick="convertToPPTX()">
          <span>ğŸ“¥</span>
          <span>PPTXë¡œ ë³€í™˜í•˜ê¸°</span>
        </button>

        <button class="btn-secondary" onclick="loadSample()">
          <span>ğŸ“„</span>
          <span>ìƒ˜í”Œ HTML ë¶ˆëŸ¬ì˜¤ê¸°</span>
        </button>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>Powered by Claude AI & PptxGenJS â€¢ Made for Career High</p>
      <p style="margin-top: 8px; font-size: 12px;">
        API ë¹„ìš©: PT 1ê°œë‹¹ ì•½ $0.10 | ë¬´ë£Œ í¬ë ˆë”§ìœ¼ë¡œ 50+ PT ìƒì„± ê°€ëŠ¥
      </p>
    </div>
  </div>

  <!-- PptxGenJS Library -->
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.min.js"></script>

  <script>
    let currentFile = null;
    let apiKey = localStorage.getItem('claude_api_key') || '';

    // Initialize
    if (apiKey) {
      document.getElementById('apiKeyInput').value = apiKey;
      updateApiStatus(true);
    }

    // Show alert
    function showAlert(message, type) {
      const alert = document.getElementById('alert');
      alert.textContent = message;
      alert.className = `alert show ${type}`;
      setTimeout(() => alert.classList.remove('show'), 5000);
    }

    // Save API Key
    function saveApiKey() {
      apiKey = document.getElementById('apiKeyInput').value.trim();
      if (!apiKey) {
        showAlert('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
        return;
      }
      localStorage.setItem('claude_api_key', apiKey);
      updateApiStatus(true);
      showAlert('âœ… API í‚¤ê°€ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
      checkGenerateButton();
    }

    // Update API status
    function updateApiStatus(connected) {
      const status = document.getElementById('apiStatus');
      if (connected) {
        status.textContent = 'ì—°ê²°ë¨';
        status.className = 'api-status connected';
      } else {
        status.textContent = 'ë¯¸ì—°ê²°';
        status.className = 'api-status disconnected';
      }
    }

    // File upload handlers
    const uploadArea = document.getElementById('uploadArea');

    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        handleFile(files[0]);
      }
    });

    function handleFileSelect(event) {
      const file = event.target.files[0];
      if (file) handleFile(file);
    }

    function handleFile(file) {
      if (!file.type.includes('pdf')) {
        showAlert('âŒ PDF íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'error');
        return;
      }

      if (file.size > 10 * 1024 * 1024) {
        showAlert('âŒ íŒŒì¼ í¬ê¸°ëŠ” 10MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.', 'error');
        return;
      }

      currentFile = file;
      document.getElementById('fileName').textContent = file.name;
      document.getElementById('fileSize').textContent = (file.size / 1024 / 1024).toFixed(2) + ' MB';
      document.getElementById('fileInfo').classList.add('show');
      
      showAlert('âœ… íŒŒì¼ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
      checkGenerateButton();
    }

    function checkGenerateButton() {
      const btn = document.getElementById('generateBtn');
      btn.disabled = !(currentFile && apiKey);
    }

    // Convert file to base64
    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => {
          const base64 = reader.result.split(',')[1];
          resolve(base64);
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    // Update progress
    function updateProgress(percent, text) {
      document.getElementById('progressContainer').classList.add('show');
      document.getElementById('progressFill').style.width = percent + '%';
      document.getElementById('progressText').textContent = text;
    }

    // Generate with AI
    async function generateWithAI() {
      if (!apiKey) {
        showAlert('âŒ API í‚¤ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”.', 'error');
        return;
      }

      if (!currentFile) {
        showAlert('âŒ PDF íŒŒì¼ì„ ë¨¼ì € ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.', 'error');
        return;
      }

      const generateBtn = document.getElementById('generateBtn');
      generateBtn.disabled = true;
      generateBtn.innerHTML = '<span>â³</span><span>AI ë¶„ì„ ì¤‘...</span>';

      try {
        // Step 1: Convert PDF to base64
        updateProgress(20, 'ğŸ“„ PDF ì½ëŠ” ì¤‘...');
        const pdfBase64 = await fileToBase64(currentFile);

        // Step 2: Prepare prompt
        updateProgress(40, 'ğŸ¤– AIì—ê²Œ ìš”ì²­ ë³´ë‚´ëŠ” ì¤‘...');
        const customPrompt = document.getElementById('customPrompt').value;
        const promptText = `ì´ PDF ê¸°íšì•ˆì„ ë¶„ì„í•´ì„œ í”„ë ˆì  í…Œì´ì…˜ìš© HTMLì„ ìƒì„±í•´ì¤˜.

ë‹¤ìŒ ê·œì¹™ì„ ë°˜ë“œì‹œ ë”°ë¼ì•¼ í•´:

1. ê° ìŠ¬ë¼ì´ë“œëŠ” <section class="slide" data-page="XX"> êµ¬ì¡°ë¡œ ì‘ì„±
2. ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸ëŠ” 01, 02, 03... í˜•ì‹ìœ¼ë¡œ
3. HTML ìš”ì†Œ:
   - <h2>: ìƒìœ„ ì œëª© (ì‘ê³  íŒŒë€ìƒ‰)
   - <h1>: ë©”ì¸ ì œëª© (í¬ê³  êµµê²Œ)
   - <p>: ë³¸ë¬¸ ë‚´ìš©
   - <ul><li>: ë¦¬ìŠ¤íŠ¸
   - <div class="key-box">: ê°•ì¡° ë°•ìŠ¤
   - <table>: ë°ì´í„° í‘œ (thead, tbody ì‚¬ìš©)

4. 20ì¥ êµ¬ì¡°ë¡œ ë§Œë“¤ì–´ì¤˜:
   - í‘œì§€ (1ì¥)
   - ëª©ì°¨ (1ì¥)
   - ë³¸ë¬¸ (16ì¥) - ë°ì´í„° í‘œë¥¼ ì ê·¹ í™œìš©
   - ê²°ë¡  (1ì¥)
   - ê°ì‚¬ ì¸ì‚¬ (1ì¥)

5. ë¸Œëœë“œ ì»¬ëŸ¬: #0071EC (íŒŒë€ìƒ‰), #5050EF (ë³´ë¼ìƒ‰)

${customPrompt ? 'ì¶”ê°€ ìš”ì²­: ' + customPrompt : ''}

HTMLë§Œ ì¶œë ¥í•˜ê³  ë‹¤ë¥¸ ì„¤ëª…ì€ í•˜ì§€ ë§ˆ.
<!DOCTYPE html>ë¶€í„° </html>ê¹Œì§€ ì™„ì „í•œ HTML ë¬¸ì„œë¥¼ ìƒì„±í•´ì¤˜.`;

        // Step 3: Call Claude API
        updateProgress(60, 'ğŸ§  AIê°€ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤... (30-60ì´ˆ ì†Œìš”)');
        
        const response = await fetch('https://api.anthropic.com/v1/messages', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'x-api-key': apiKey,
            'anthropic-version': '2023-06-01'
          },
          body: JSON.stringify({
            model: 'claude-sonnet-4-20250514',
            max_tokens: 4096,
            messages: [{
              role: 'user',
              content: [
                {
                  type: 'document',
                  source: {
                    type: 'base64',
                    media_type: 'application/pdf',
                    data: pdfBase64
                  }
                },
                {
                  type: 'text',
                  text: promptText
                }
              ]
            }]
          })
        });

        if (!response.ok) {
          const error = await response.json();
          throw new Error(error.error?.message || 'API í˜¸ì¶œ ì‹¤íŒ¨');
        }

        const data = await response.json();
        
        // Step 4: Extract HTML
        updateProgress(80, 'ğŸ“ HTML ìƒì„± ì¤‘...');
        const generatedText = data.content[0].text;
        
        // Extract HTML from response
        let html = generatedText;
        if (html.includes('```html')) {
          html = html.split('```html')[1].split('```')[0].trim();
        } else if (html.includes('```')) {
          html = html.split('```')[1].split('```')[0].trim();
        }

        // Step 5: Display result
        updateProgress(100, 'âœ… ì™„ë£Œ!');
        document.getElementById('htmlEditor').value = html;
        showAlert('âœ… AIê°€ ì„±ê³µì ìœ¼ë¡œ HTMLì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤! ë‚´ìš©ì„ í™•ì¸í•˜ê³  PPTXë¡œ ë³€í™˜í•˜ì„¸ìš”.', 'success');

        setTimeout(() => {
          document.getElementById('progressContainer').classList.remove('show');
        }, 2000);

      } catch (error) {
        console.error(error);
        showAlert('âŒ ì˜¤ë¥˜: ' + error.message, 'error');
        updateProgress(0, '');
        document.getElementById('progressContainer').classList.remove('show');
      } finally {
        generateBtn.disabled = false;
        generateBtn.innerHTML = '<span>ğŸ¤–</span><span>AIë¡œ ìë™ ìƒì„±í•˜ê¸°</span>';
      }
    }

    // Convert to PPTX
    async function convertToPPTX() {
      const html = document.getElementById('htmlEditor').value.trim();

      if (!html) {
        showAlert('âŒ HTML ì½”ë“œê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
        return;
      }

      showAlert('â³ PPTX íŒŒì¼ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');

      try {
        const pptx = new PptxGenJS();
        pptx.layout = 'LAYOUT_16x9';
        pptx.author = 'Career High';
        pptx.title = 'AI Generated Presentation';

        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const slides = doc.querySelectorAll('.slide');

        if (slides.length === 0) {
          throw new Error('ìŠ¬ë¼ì´ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. class="slide"ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
        }

        slides.forEach((slideElement) => {
          const slide = pptx.addSlide();
          slide.background = { color: 'FFFFFF' };
          let yPosition = 1.2;

          // H2
          const h2 = slideElement.querySelector('h2');
          if (h2) {
            slide.addText(h2.textContent.trim(), {
              x: 0.8, y: yPosition, fontSize: 14, color: '0071EC',
              bold: true, fontFace: 'Arial'
            });
            yPosition += 0.4;
          }

          // H1
          const h1 = slideElement.querySelector('h1');
          if (h1) {
            const h1Text = h1.innerHTML.replace(/<br\s*\/?>/gi, '\n');
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = h1Text;
            slide.addText(tempDiv.textContent.trim(), {
              x: 0.8, y: yPosition, w: 8, fontSize: 42, color: '111111',
              bold: true, fontFace: 'Arial', lineSpacing: 48
            });
            yPosition += 1.4;
          }

          // P
          const paragraphs = slideElement.querySelectorAll('p');
          paragraphs.forEach(p => {
            const pText = p.innerHTML.replace(/<br\s*\/?>/gi, '\n');
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = pText;
            slide.addText(tempDiv.textContent.trim(), {
              x: 0.8, y: yPosition, w: 8, fontSize: 18, color: '666666',
              fontFace: 'Arial', lineSpacing: 28
            });
            yPosition += 0.8;
          });

          // UL
          const ul = slideElement.querySelector('ul');
          if (ul) {
            const items = ul.querySelectorAll('li');
            items.forEach(li => {
              slide.addText('â€¢ ' + li.textContent.trim(), {
                x: 1.0, y: yPosition, w: 8, fontSize: 18,
                color: '666666', fontFace: 'Arial'
              });
              yPosition += 0.4;
            });
          }

          // key-box
          const keyBox = slideElement.querySelector('.key-box');
          if (keyBox) {
            slide.addShape(pptx.ShapeType.rect, {
              x: 0.8, y: yPosition, w: 8, h: 0.8,
              fill: { color: 'E8F4FF' },
              line: { color: '0071EC', pt: 4 }
            });
            slide.addText(keyBox.textContent.trim(), {
              x: 1.0, y: yPosition + 0.15, w: 7.6, fontSize: 18,
              color: '111111', fontFace: 'Arial', bold: true
            });
            yPosition += 1.0;
          }

          // Table
          const table = slideElement.querySelector('table');
          if (table) {
            const rows = [];
            const thead = table.querySelector('thead');
            if (thead) {
              const headerCells = thead.querySelectorAll('th');
              rows.push(Array.from(headerCells).map(th => ({
                text: th.textContent.trim(),
                options: { bold: true, color: 'FFFFFF', fill: '0071EC', fontSize: 16 }
              })));
            }
            const tbody = table.querySelector('tbody');
            if (tbody) {
              tbody.querySelectorAll('tr').forEach(tr => {
                rows.push(Array.from(tr.querySelectorAll('td')).map(td => ({
                  text: td.textContent.trim(),
                  options: { fontSize: 14, color: '111111' }
                })));
              });
            }
            slide.addTable(rows, {
              x: 0.8, y: yPosition, w: 8,
              border: { pt: 1, color: 'E5E7EB' }, rowH: 0.4
            });
          }

          // Slide number
          const pageNum = slideElement.getAttribute('data-page');
          if (pageNum) {
            slide.addText(pageNum, {
              x: 8.8, y: 4.8, fontSize: 12, color: 'DDDDDD',
              bold: true, fontFace: 'Arial'
            });
          }
        });

        await pptx.writeFile({ fileName: 'AI_Generated_Presentation.pptx' });
        showAlert(`âœ… ì„±ê³µ! ${slides.length}ê°œ ìŠ¬ë¼ì´ë“œê°€ í¬í•¨ëœ PPTXê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');

      } catch (error) {
        console.error(error);
        showAlert('âŒ ë³€í™˜ ì˜¤ë¥˜: ' + error.message, 'error');
      }
    }

    // Load sample
    function loadSample() {
      const sample = `<!DOCTYPE html>
<html lang="ko">
<head><meta charset="UTF-8" /></head>
<body>
  <section class="slide" data-page="01">
    <h2>ìƒ˜í”Œ</h2>
    <h1>ì´ê²ƒì€ ìƒ˜í”Œ<br>ìŠ¬ë¼ì´ë“œì…ë‹ˆë‹¤</h1>
    <p>ì‹¤ì œ PTëŠ” AIê°€ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.</p>
  </section>
</body>
</html>`;
      document.getElementById('htmlEditor').value = sample;
      showAlert('ìƒ˜í”Œ HTMLì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
    }
  </script>
</body>
</html>
