<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Career High PT Converter</title>
  
  <style>
    /* =========================================
       Career High Style System
       ========================================= */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Pretendard", "Apple SD Gothic Neo", sans-serif;
      background: #F4F6F8;
      color: #333;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      width: 100%;
      max-width: 1000px;
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      padding: 40px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      border-bottom: 2px solid #F4F6F8;
      padding-bottom: 20px;
    }

    h1 {
      color: #0071EC;
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #666;
      font-size: 16px;
    }

    .input-area {
      margin-bottom: 30px;
    }

    label {
      display: block;
      font-weight: 700;
      margin-bottom: 10px;
      color: #333;
    }

    textarea {
      width: 100%;
      height: 300px;
      padding: 20px;
      border: 2px solid #E5E7EB;
      border-radius: 12px;
      font-family: 'Consolas', monospace;
      font-size: 14px;
      resize: vertical;
      line-height: 1.5;
    }

    textarea:focus {
      outline: none;
      border-color: #0071EC;
      background-color: #F8FAFC;
    }

    .btn-area {
      text-align: center;
    }

    button {
      background: #0071EC;
      color: white;
      border: none;
      padding: 16px 40px;
      font-size: 18px;
      font-weight: 700;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      width: 100%;
    }

    button:hover {
      background: #005bbd;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 113, 236, 0.3);
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      font-weight: 600;
      display: none;
    }
    .status.success { background: #E3FCEF; color: #006644; }
    .status.error { background: #FFEBE6; color: #BF2600; }
    .status.info { background: #DEEBFF; color: #0747A6; }

    .guide-box {
      background: #F8F9FA;
      padding: 20px;
      border-radius: 8px;
      margin-top: 30px;
      font-size: 14px;
      color: #666;
      line-height: 1.6;
    }
  </style>
  
  <!-- PptxGenJS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.min.js"></script>
</head>
<body>

  <div class="container">
    <div class="header">
      <h1>Career High PT Generator</h1>
      <p class="subtitle">Claudeê°€ ìƒì„±í•œ HTML ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”</p>
    </div>

    <div class="input-area">
      <label>HTML ì½”ë“œ ì…ë ¥</label>
      <textarea id="htmlInput" placeholder="ì—¬ê¸°ì— Claudeê°€ ë§Œë“  ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
    </div>

    <div class="btn-area">
      <button id="convertBtn">PPTX íŒŒì¼ë¡œ ë³€í™˜í•˜ê¸°</button>
    </div>

    <div id="statusMessage" class="status"></div>

    <div class="guide-box">
      <strong>ğŸ“Œ ê°€ì´ë“œë¶ ì‚¬ì–‘ ì¤€ìˆ˜ (Fixed Layout)</strong>
      <ul style="margin-left: 20px; margin-top: 10px;">
        <li>H1 ì œëª©: 32pt (Arial Bold)</li>
        <li>ë³¸ë¬¸ ë‚´ìš©: 14pt (ê°€ë…ì„± ìµœì í™”)</li>
        <li>ë°ì´í„° í‘œ: 11-12pt (íŒŒë€ìƒ‰ í—¤ë”)</li>
        <li>ë¸Œëœë“œ ì»¬ëŸ¬: #0071EC ì ìš©</li>
      </ul>
    </div>
  </div>

  <script>
    const convertBtn = document.getElementById('convertBtn');
    const htmlInput = document.getElementById('htmlInput');
    const statusMessage = document.getElementById('statusMessage');

    function showStatus(msg, type) {
      statusMessage.textContent = msg;
      statusMessage.className = `status show ${type}`;
      statusMessage.style.display = 'block';
    }

    convertBtn.addEventListener('click', async () => {
      const html = htmlInput.value.trim();
      
      if (!html) {
        showStatus('HTML ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
        return;
      }

      convertBtn.disabled = true;
      convertBtn.textContent = 'ë³€í™˜ ì¤‘...';
      showStatus('PPTX íŒŒì¼ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');

      try {
        const pptx = new PptxGenJS();
        
        // 1. ê¸°ë³¸ ì„¤ì • (ê°€ì´ë“œë¶ ì‚¬ì–‘)
        pptx.layout = 'LAYOUT_16x9';
        pptx.author = 'Career High';
        pptx.title = 'Presentation';

        // 2. HTML íŒŒì‹±
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const slides = doc.querySelectorAll('.slide');

        if (slides.length === 0) {
          throw new Error('ìŠ¬ë¼ì´ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (class="slide" ëˆ„ë½ í™•ì¸)');
        }

        // 3. ìŠ¬ë¼ì´ë“œ ë£¨í”„
        slides.forEach((slideElem) => {
          const slide = pptx.addSlide();
          slide.background = { color: 'FFFFFF' };

          // Yì¶• ì»¤ì„œ (ìœ„ì—ì„œ ì•„ë˜ë¡œ ìŒ“ì´ëŠ” êµ¬ì¡°)
          let yPos = 0.5;

          // [ìš”ì†Œ 1] ì†Œì œëª© (H2) - íŒŒë€ìƒ‰, ì‘ê²Œ
          const h2 = slideElem.querySelector('h2');
          if (h2) {
            slide.addText(h2.textContent.trim(), {
              x: 0.5, y: yPos, w: 9.0, h: 0.3,
              fontSize: 14, color: '0071EC', bold: true, fontFace: 'Arial'
            });
            yPos += 0.35;
          }

          // [ìš”ì†Œ 2] ë©”ì¸ ì œëª© (H1) - ê²€ì •, 32pt (ê°€ì´ë“œë¶ ì¤€ìˆ˜)
          const h1 = slideElem.querySelector('h1');
          if (h1) {
            // ì¤„ë°”ê¿ˆ íƒœê·¸ ì²˜ë¦¬
            let titleText = h1.innerHTML.replace(/<br\s*\/?>/gi, '\n');
            // HTML íƒœê·¸ ì œê±°
            const temp = document.createElement('div');
            temp.innerHTML = titleText;
            titleText = temp.textContent;

            slide.addText(titleText, {
              x: 0.5, y: yPos, w: 9.0,
              fontSize: 32, color: '111111', bold: true, fontFace: 'Arial',
              lineSpacing: 38
            });
            yPos += 1.2; // ì œëª© ì—¬ë°± í™•ë³´
          }

          // [ìš”ì†Œ 3] Key Box (ê°•ì¡° ë°•ìŠ¤)
          const keyBox = slideElem.querySelector('.key-box');
          if (keyBox) {
            // íŒŒë€ìƒ‰ ë°°ê²½ ë°•ìŠ¤
            slide.addShape(pptx.ShapeType.rect, {
              x: 0.5, y: yPos, w: 9.0, h: 0.8,
              fill: { color: 'E8F4FF' },
              line: { color: '0071EC', width: 3 } // ì™¼ìª½ í…Œë‘ë¦¬ ëŒ€ì‹  ì „ì²´ í…Œë‘ë¦¬ë¡œ ì•ˆì •ì„± í™•ë³´
            });
            
            // ë°•ìŠ¤ ì•ˆ í…ìŠ¤íŠ¸
            slide.addText(keyBox.textContent.trim(), {
              x: 0.7, y: yPos + 0.1, w: 8.6,
              fontSize: 14, color: '111111', bold: true, fontFace: 'Arial'
            });
            yPos += 1.0;
          }

          // [ìš”ì†Œ 4] ë³¸ë¬¸ (P) - 14pt (ê°€ì´ë“œë¶ ì¤€ìˆ˜)
          const ps = slideElem.querySelectorAll('p:not(.key-box)');
          ps.forEach(p => {
             slide.addText(p.textContent.trim(), {
               x: 0.5, y: yPos, w: 9.0,
               fontSize: 14, color: '666666', fontFace: 'Arial', lineSpacing: 20
             });
             yPos += 0.5;
          });

          // [ìš”ì†Œ 5] ë¦¬ìŠ¤íŠ¸ (UL > LI)
          const ul = slideElem.querySelector('ul');
          if (ul) {
            const lis = ul.querySelectorAll('li');
            lis.forEach(li => {
              slide.addText('â€¢ ' + li.textContent.trim(), {
                x: 0.6, y: yPos, w: 8.9,
                fontSize: 14, color: '444444', fontFace: 'Arial',
                breakLine: true
              });
              yPos += 0.35;
            });
          }

          // [ìš”ì†Œ 6] ë°ì´í„° í‘œ (Table) - 11~12pt (ê°€ì´ë“œë¶ ì¤€ìˆ˜)
          const table = slideElem.querySelector('table');
          if (table) {
            const rows = [];
            
            // í—¤ë” (thead)
            const thead = table.querySelector('thead');
            if (thead) {
              const ths = thead.querySelectorAll('th');
              rows.push(Array.from(ths).map(th => ({
                text: th.textContent.trim(),
                options: { 
                  fill: '0071EC', color: 'FFFFFF', bold: true, 
                  fontSize: 12, align: 'center' 
                }
              })));
            }

            // ë³¸ë¬¸ (tbody)
            const trs = table.querySelectorAll('tbody tr');
            trs.forEach(tr => {
              const tds = tr.querySelectorAll('td');
              rows.push(Array.from(tds).map(td => ({
                text: td.textContent.trim(),
                options: { 
                  fontSize: 11, color: '333333', 
                  fill: 'FFFFFF', align: 'left' 
                }
              })));
            });

            if (rows.length > 0) {
              slide.addTable(rows, {
                x: 0.5, y: yPos, w: 9.0,
                border: { color: 'E2E8F0', pt: 1 },
                rowH: 0.4
              });
            }
          }

          // [ìš”ì†Œ 7] ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸
          const pageNum = slideElem.getAttribute('data-page');
          if (pageNum) {
            slide.addText(pageNum, {
              x: 9.0, y: 5.2, fontSize: 10, color: 'BBBBBB', bold: true
            });
          }

        });

        // 4. ì €ì¥
        await pptx.writeFile({ fileName: 'Presentation_Fixed.pptx' });
        showStatus('âœ… ì™„ë£Œ! ë‹¤ìš´ë¡œë“œ í´ë”ë¥¼ í™•ì¸í•˜ì„¸ìš”.', 'success');

      } catch (error) {
        console.error(error);
        showStatus('âŒ ì˜¤ë¥˜: ' + error.message, 'error');
      } finally {
        convertBtn.disabled = false;
        convertBtn.textContent = 'PPTX íŒŒì¼ë¡œ ë³€í™˜í•˜ê¸°';
      }
    });
  </script>
</body>
</html>