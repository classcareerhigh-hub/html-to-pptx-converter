<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTML to PPTX Converter - Career High (Fixed)</title>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
      background: linear-gradient(135deg, #EBF4FF 0%, #E0E7FF 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Header */
    .header {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      padding: 40px;
      margin-bottom: 24px;
    }

    .header-content {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 24px;
    }

    .logo {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #0071EC 0%, #5050EF 100%);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
    }

    h1 {
      font-size: 32px;
      font-weight: 700;
      color: #111;
    }

    .subtitle {
      color: #666;
      font-size: 16px;
      margin-top: 4px;
    }

    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-top: 24px;
    }

    .feature {
      background: #EBF4FF;
      padding: 16px;
      border-radius: 8px;
      font-size: 14px;
    }

    .feature-title {
      font-weight: 600;
      color: #0071EC;
      margin-bottom: 4px;
    }

    .feature-desc {
      color: #666;
      font-size: 13px;
    }

    /* Main Content */
    .main-content {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      padding: 40px;
      margin-bottom: 24px;
    }

    .section-title {
      font-size: 20px;
      font-weight: 700;
      color: #111;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-icon {
      font-size: 20px;
    }

    textarea {
      width: 100%;
      height: 400px;
      padding: 16px;
      border: 2px solid #E5E7EB;
      border-radius: 12px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      resize: vertical;
      transition: border-color 0.2s;
    }

    textarea:focus {
      outline: none;
      border-color: #0071EC;
    }

    .button-group {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    button {
      padding: 14px 28px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #0071EC 0%, #5050EF 100%);
      color: white;
      flex: 1;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 113, 236, 0.3);
    }

    .btn-primary:disabled {
      background: #D1D5DB;
      cursor: not-allowed;
      transform: none;
    }

    .btn-secondary {
      background: #F3F4F6;
      color: #374151;
    }

    .btn-secondary:hover {
      background: #E5E7EB;
    }

    /* Status Message */
    .status {
      margin-top: 16px;
      padding: 16px;
      border-radius: 8px;
      display: none;
      align-items: start;
      gap: 12px;
    }

    .status.show {
      display: flex;
    }

    .status.success {
      background: #D1FAE5;
      border: 1px solid #34D399;
      color: #065F46;
    }

    .status.error {
      background: #FEE2E2;
      border: 1px solid #F87171;
      color: #991B1B;
    }

    .status.info {
      background: #DBEAFE;
      border: 1px solid #60A5FA;
      color: #1E40AF;
    }

    /* Instructions */
    .instructions {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      padding: 40px;
    }

    .supported-elements {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }

    .element {
      background: #F9FAFB;
      padding: 12px;
      border-radius: 8px;
      font-size: 13px;
    }

    .element code {
      color: #0071EC;
      font-weight: 600;
      font-family: 'Courier New', monospace;
    }

    .element-desc {
      color: #6B7280;
      margin-top: 4px;
    }

    /* Footer */
    .footer {
      text-align: center;
      color: #6B7280;
      font-size: 14px;
      margin-top: 24px;
    }

    /* Tip Box */
    .tip-box {
      background: #FEF3C7;
      border: 1px solid #FCD34D;
      border-radius: 8px;
      padding: 16px;
      margin-top: 16px;
      font-size: 14px;
      color: #78350F;
    }

    .tip-box strong {
      color: #92400E;
    }

    .tip-box code {
      background: white;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="header-content">
        <div class="logo">ğŸ“Š</div>
        <div>
          <h1>HTML to PPTX Converter</h1>
          <p class="subtitle">ë””ìì¸ì„ ìœ ì§€í•˜ë©´ì„œ HTMLì„ PowerPointë¡œ ë³€í™˜í•©ë‹ˆë‹¤</p>
        </div>
      </div>

      <div class="features">
        <div class="feature">
          <div class="feature-title">âœ… 16:9 ë¹„ìœ¨ ìœ ì§€</div>
          <div class="feature-desc">í”„ë ˆì  í…Œì´ì…˜ ìµœì í™”</div>
        </div>
        <div class="feature">
          <div class="feature-title">ğŸ¨ ìŠ¤íƒ€ì¼ ë³´ì¡´</div>
          <div class="feature-desc">ìƒ‰ìƒ, í°íŠ¸, ë ˆì´ì•„ì›ƒ</div>
        </div>
        <div class="feature">
          <div class="feature-title">âš¡ ì¦‰ì‹œ ë‹¤ìš´ë¡œë“œ</div>
          <div class="feature-desc">ì„¤ì¹˜ ì—†ì´ ë¸Œë¼ìš°ì €ì—ì„œ</div>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <h2 class="section-title">
        <span class="section-icon">ğŸ“</span>
        HTML ì½”ë“œ ì…ë ¥
      </h2>

      <textarea id="htmlInput" placeholder="HTML ì½”ë“œë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...

ì˜ˆì‹œ:
<section class='slide' data-page='01'>
  <h2>Design Guide</h2>
  <h1>Title Here</h1>
  <p>Description text...</p>
</section>"></textarea>

      <div class="tip-box">
        <strong>ğŸ’¡ ì‚¬ìš© íŒ:</strong> HTMLì—ì„œ <code>class="slide"</code>ë¡œ ëœ sectionì´ ê°ê° í•˜ë‚˜ì˜ ìŠ¬ë¼ì´ë“œê°€ ë©ë‹ˆë‹¤.
      </div>

      <div class="button-group">
        <button class="btn-primary" id="convertBtn">
          <span>ğŸ“¥</span>
          <span>PPTX íŒŒì¼ë¡œ ë³€í™˜í•˜ê¸°</span>
        </button>
        <button class="btn-secondary" id="loadSampleBtn">
          <span>ğŸ“„</span>
          <span>ìƒ˜í”Œ ë¶ˆëŸ¬ì˜¤ê¸°</span>
        </button>
      </div>

      <div id="statusMessage" class="status"></div>
    </div>

    <!-- Instructions -->
    <div class="instructions">
      <h2 class="section-title">
        <span class="section-icon">ğŸ“‹</span>
        ì§€ì›ë˜ëŠ” HTML ìš”ì†Œ
      </h2>

      <div class="supported-elements">
        <div class="element">
          <code>&lt;h2&gt;</code>
          <div class="element-desc">ì†Œì œëª© (14pt, íŒŒë€ìƒ‰)</div>
        </div>
        <div class="element">
          <code>&lt;h1&gt;</code>
          <div class="element-desc">ì œëª© (42pt, ë³¼ë“œ)</div>
        </div>
        <div class="element">
          <code>&lt;p&gt;</code>
          <div class="element-desc">ë³¸ë¬¸ (18pt, íšŒìƒ‰)</div>
        </div>
        <div class="element">
          <code>&lt;ul&gt;&lt;li&gt;</code>
          <div class="element-desc">ë¶ˆë¦¿ ë¦¬ìŠ¤íŠ¸</div>
        </div>
        <div class="element">
          <code>.key-box</code>
          <div class="element-desc">ê°•ì¡° ë°•ìŠ¤ (íŒŒë€ í…Œë‘ë¦¬)</div>
        </div>
        <div class="element">
          <code>&lt;table&gt;</code>
          <div class="element-desc">ë°ì´í„° í‘œ</div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>Powered by PptxGenJS â€¢ Made for Career High</p>
    </div>
  </div>

  <!-- PptxGenJS Library - Using unpkg CDN -->
  <script src="https://unpkg.com/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

  <script>
    // Wait for library to load
    window.addEventListener('load', function() {
      console.log('PptxGenJS loaded:', typeof window.PptxGenJS, typeof window.pptxgen);
    });

    // Elements
    const htmlInput = document.getElementById('htmlInput');
    const convertBtn = document.getElementById('convertBtn');
    const loadSampleBtn = document.getElementById('loadSampleBtn');
    const statusMessage = document.getElementById('statusMessage');

    // Show status message
    function showStatus(message, type) {
      statusMessage.textContent = message;
      statusMessage.className = `status show ${type}`;
    }

    // Load sample HTML
    loadSampleBtn.addEventListener('click', () => {
      const sampleHTML = `<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <style>
    .slide { background: white; padding: 80px; }
    h1 { font-size: 56px; color: #111111; }
    h2 { font-size: 20px; color: #0071EC; }
    p { font-size: 24px; color: #666666; }
    .highlight { color: #5050EF; font-weight: 600; }
    .key-box { border-left: 6px solid #0071EC; padding: 24px; background: rgba(0,113,236,0.04); }
  </style>
</head>
<body>
  <section class="slide" data-page="01">
    <h2>Design Guide</h2>
    <h1>Education Template<br>16:9 Widescreen</h1>
    <p>ì´ í…œí”Œë¦¿ì€ í”„ë ˆì  í…Œì´ì…˜ í™˜ê²½ì— ìµœì í™”ëœ<br><span class="highlight">16:9 ê³ ì • ë¹„ìœ¨</span> ë ˆì´ì•„ì›ƒì„ ì œê³µí•©ë‹ˆë‹¤.</p>
  </section>

  <section class="slide" data-page="02">
    <h2>Layout Rules</h2>
    <h1>ì—¬ë°±ì´ ê³§ ì½˜í…ì¸ ì…ë‹ˆë‹¤</h1>
    <p>16:9 ë¹„ìœ¨ì—ì„œëŠ” ê°€ë¡œ ê³µê°„ì´ ë„“ìŠµë‹ˆë‹¤.<br>í…ìŠ¤íŠ¸ë¥¼ ê½‰ ì±„ìš°ì§€ ë§ê³ , <span class="highlight">ì¢Œì¸¡ ì •ë ¬</span>ì„ ìœ ì§€í•˜ì—¬ ì‹œì„ ì˜ íë¦„ì„ ë„ìš°ì„¸ìš”.</p>
    <div class="key-box">í™”ë©´ ì¤‘ì•™ì— ì ì ˆí•œ ì—¬ë°±(Margin)ì„ ë‘ì–´ ìˆ¨ ì‰´ ê³µê°„ì„ ë§Œë“­ë‹ˆë‹¤.</div>
  </section>

  <section class="slide" data-page="03">
    <h2>Usage</h2>
    <h1>ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ì„¸ìš”</h1>
    <p>HTML íŒŒì¼ ë‚´ì˜ section class="slide" ì „ì²´ë¥¼ ë³µì‚¬í•˜ë©´<br>ìƒˆë¡œìš´ í˜ì´ì§€ê°€ ìƒì„±ë©ë‹ˆë‹¤.</p>
    <ul>
      <li><strong>H1 (Title):</strong> 56px / Bold / #111111</li>
      <li><strong>P (Body):</strong> 24px / Regular / #666666</li>
      <li><strong>Color:</strong> Primary Blue (#0071EC)</li>
    </ul>
  </section>
</body>
</html>`;
      htmlInput.value = sampleHTML;
      showStatus('ìƒ˜í”Œ HTMLì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
    });

    // Convert HTML to PPTX
    convertBtn.addEventListener('click', async () => {
      const html = htmlInput.value.trim();

      if (!html) {
        showStatus('HTML ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
        return;
      }

      convertBtn.disabled = true;
      convertBtn.innerHTML = '<span>â³</span><span>ë³€í™˜ ì¤‘...</span>';
      showStatus('PPTX íŒŒì¼ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');

      try {
        // Create PptxGenJS instance - try both possible names
        let pptx;
        if (typeof window.PptxGenJS !== 'undefined') {
          pptx = new window.PptxGenJS();
        } else if (typeof window.pptxgen !== 'undefined') {
          pptx = new window.pptxgen();
        } else {
          throw new Error('PptxGenJS ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        }

        pptx.layout = 'LAYOUT_16x9';
        pptx.author = 'Career High';
        pptx.title = 'Education Template';

        // Parse HTML
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const slides = doc.querySelectorAll('.slide');

        if (slides.length === 0) {
          throw new Error('ìŠ¬ë¼ì´ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. class="slide"ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
        }

        // Process each slide
        slides.forEach((slideElement) => {
          const slide = pptx.addSlide();
          slide.background = { color: 'FFFFFF' };

          let yPosition = 1.2;

          // H2 (subtitle)
          const h2 = slideElement.querySelector('h2');
          if (h2) {
            slide.addText(h2.textContent.trim(), {
              x: 0.8,
              y: yPosition,
              fontSize: 14,
              color: '0071EC',
              bold: true,
              fontFace: 'Arial'
            });
            yPosition += 0.4;
          }

          // H1 (title)
          const h1 = slideElement.querySelector('h1');
          if (h1) {
            const h1Text = h1.innerHTML.replace(/<br\s*\/?>/gi, '\n');
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = h1Text;

            slide.addText(tempDiv.textContent.trim(), {
              x: 0.8,
              y: yPosition,
              w: 8,
              fontSize: 42,
              color: '111111',
              bold: true,
              fontFace: 'Arial',
              lineSpacing: 48
            });
            yPosition += 1.4;
          }

          // P (paragraphs)
          const paragraphs = slideElement.querySelectorAll('p');
          paragraphs.forEach(p => {
            const pText = p.innerHTML.replace(/<br\s*\/?>/gi, '\n');
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = pText;

            slide.addText(tempDiv.textContent.trim(), {
              x: 0.8,
              y: yPosition,
              w: 8,
              fontSize: 18,
              color: '666666',
              fontFace: 'Arial',
              lineSpacing: 28
            });
            yPosition += 0.8;
          });

          // UL (lists)
          const ul = slideElement.querySelector('ul');
          if (ul) {
            const items = ul.querySelectorAll('li');
            items.forEach(li => {
              slide.addText('â€¢ ' + li.textContent.trim(), {
                x: 1.0,
                y: yPosition,
                w: 8,
                fontSize: 18,
                color: '666666',
                fontFace: 'Arial'
              });
              yPosition += 0.4;
            });
          }

          // key-box
          const keyBox = slideElement.querySelector('.key-box');
          if (keyBox) {
            slide.addShape(pptx.ShapeType.rect, {
              x: 0.8,
              y: yPosition,
              w: 8,
              h: 0.8,
              fill: { color: 'E8F4FF' },
              line: { color: '0071EC', pt: 4 }
            });

            slide.addText(keyBox.textContent.trim(), {
              x: 1.0,
              y: yPosition + 0.15,
              w: 7.6,
              fontSize: 18,
              color: '111111',
              fontFace: 'Arial',
              bold: true
            });
            yPosition += 1.0;
          }

          // Table
          const table = slideElement.querySelector('table');
          if (table) {
            const rows = [];
            
            // Header
            const thead = table.querySelector('thead');
            if (thead) {
              const headerCells = thead.querySelectorAll('th');
              const headerRow = Array.from(headerCells).map(th => ({
                text: th.textContent.trim(),
                options: { bold: true, color: 'FFFFFF', fill: '0071EC', fontSize: 16 }
              }));
              rows.push(headerRow);
            }

            // Body
            const tbody = table.querySelector('tbody');
            if (tbody) {
              const bodyRows = tbody.querySelectorAll('tr');
              bodyRows.forEach(tr => {
                const cells = tr.querySelectorAll('td');
                const row = Array.from(cells).map(td => ({
                  text: td.textContent.trim(),
                  options: { fontSize: 14, color: '111111' }
                }));
                rows.push(row);
              });
            }

            slide.addTable(rows, {
              x: 0.8,
              y: yPosition,
              w: 8,
              border: { pt: 1, color: 'E5E7EB' },
              rowH: 0.4
            });
          }

          // Slide number
          const pageNum = slideElement.getAttribute('data-page');
          if (pageNum) {
            slide.addText(pageNum, {
              x: 8.8,
              y: 4.8,
              fontSize: 12,
              color: 'DDDDDD',
              bold: true,
              fontFace: 'Arial'
            });
          }
        });

        // Generate and download
        await pptx.writeFile({ fileName: 'Education_Template_16x9.pptx' });
        showStatus(`âœ… ë³€í™˜ ì™„ë£Œ! ${slides.length}ê°œ ìŠ¬ë¼ì´ë“œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');

      } catch (error) {
        console.error(error);
        showStatus('âŒ ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
      } finally {
        convertBtn.disabled = false;
        convertBtn.innerHTML = '<span>ğŸ“¥</span><span>PPTX íŒŒì¼ë¡œ ë³€í™˜í•˜ê¸°</span>';
      }
    });
  </script>
</body>
</html>
